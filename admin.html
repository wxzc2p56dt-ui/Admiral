<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="bg-gray-100 font-[Manrope]">

  <!-- üîπ –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ -->
  <div class="flex min-h-screen">

    <!-- üü¶ –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
    <aside class="w-64 bg-black text-white flex flex-col py-6 px-4 space-y-4 shadow-lg">
      <h1 class="text-2xl font-bold mb-6 pl-2">–ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å</h1>

      <button class="tab-btn active w-full text-left px-4 py-2 bg-white hover:bg-white text-blue-700 hover:text-blue-700 rounded-lg font-medium" data-tab="sliders">–°–ª–∞–π–¥–µ—Ä—ã</button>
      <button class="tab-btn w-full text-left px-4 py-2 hover:bg-white hover:text-blue-700 rounded-lg font-medium" data-tab="news">–ù–æ–≤–æ—Å—Ç–∏</button>
      <button class="tab-btn w-full text-left px-4 py-2 hover:bg-white hover:text-blue-700 rounded-lg font-medium" data-tab="database">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</button>

      <div class="flex-grow"></div>
      <button class="mt-auto bg-blue-900 hover:bg-blue-800 px-4 py-2 rounded-lg text-sm text-gray-200">
        –í—ã–π—Ç–∏
      </button>
    </aside>

    <!-- üü© –ö–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="flex-1 p-8 overflow-y-auto">

      <!-- üì∏ –°–õ–ê–ô–î–ï–†–´ -->
      <section id="sliders" class="tab-content">
        <h2 class="text-3xl font-bold mb-4">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–∞–π–¥–∞–º–∏</h2>

        <form id="sliderForm" class="bg-white p-6 rounded-2xl shadow space-y-4 mb-8">
          <div>
            <label class="block text-sm font-medium mb-1">–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
            <input type="text" id="sliderTitle" class="w-full border rounded-lg px-3 py-2" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫" />
          </div>
          <div>
            <label class="block text-sm font-medium mb-1">–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea id="sliderDesc" class="w-full border rounded-lg px-3 py-2" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ..."></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium mb-1">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
            <input type="file" id="sliderImage" accept="image/*" class="w-full border rounded-lg px-3 py-2 bg-gray-50" />
          </div>
          <button type="button" id="addSlider" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
            –î–æ–±–∞–≤–∏—Ç—å —Å–ª–∞–π–¥
          </button>
        </form>

        <h3 class="text-lg font-semibold mb-3">üìã –¢–µ–∫—É—â–∏–µ —Å–ª–∞–π–¥—ã</h3>
        <div id="sliderList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
      </section>

      <!-- üì∞ –ù–û–í–û–°–¢–ò -->
      <section id="news" class="tab-content hidden">
        <h2 class="text-3xl font-bold mb-4">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç—è–º–∏</h2>

        <form id="newsForm" class="bg-white p-6 rounded-2xl shadow space-y-4 mb-8">
          <div>
            <label class="block text-sm font-medium mb-1">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏</label>
            <input type="text" id="newsTitle" class="w-full border rounded-lg px-3 py-2" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫" />
          </div>
          <div>
            <label class="block text-sm font-medium mb-1">–¢–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏</label>
            <textarea id="newsContent" class="w-full border rounded-lg px-3 py-2" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏..."></textarea>
          </div>
           <div>
            <label class="block text-sm font-medium mb-1">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
            <input type="file" id="sliderImage" accept="image/*" class="w-full border rounded-lg px-3 py-2 bg-gray-50" />
          </div>
          <button type="button" id="addNews" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
            –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
          </button>
        </form>

        <h3 class="text-lg font-semibold mb-3">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏</h3>
        <div id="newsList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
      </section>

      <!-- üíæ –ë–ê–ó–ê –î–ê–ù–ù–´–• -->
      <section id="database" class="tab-content hidden relative">

        <h2 class="text-3xl font-bold mb-4">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</h2>

        <table id="dataTable" class="w-full border-collapse bg-white shadow rounded-lg overflow-hidden">
  <thead class="bg-black text-white">
    <tr>
      <th class="p-3 text-left">ID</th>
      <th class="p-3 text-left cursor-pointer select-none group" id="departmentHeader">
        <div class="flex items-center gap-2">
          <span>–û—Ç–¥–µ–ª</span>
          <svg id="deptArrow" class="w-4 h-4 transition-transform duration-300 group-hover:text-yellow-300"
               fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </div>
<div id="metroList" 
     class="hidden absolute bg-white shadow-lg rounded-lg p-4 mt-1 w-64 border border-gray-200 overflow-y-auto max-h-64 z-50">
  <p class="font-semibold mb-2">–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ:</p>
  <ul class="space-y-2">
    <li class="text-black font-semibold cursor-pointer hover:text-blue-600" data-filter="all">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ</li>
    <li class="text-black cursor-pointer hover:text-blue-600" data-filter="–ö–æ–ª–æ–º–µ–Ω—Å–∫–∞—è">–º. –ö–æ–ª–æ–º–µ–Ω—Å–∫–∞—è</li>
    <li class="text-black cursor-pointer hover:text-blue-600" data-filter="–ö–ª–µ–Ω–æ–≤—ã–π –±—É–ª—å–≤–∞—Ä">–º. –ö–ª–µ–Ω–æ–≤—ã–π –±—É–ª—å–≤–∞—Ä</li>
    <li class="text-black cursor-pointer hover:text-blue-600" data-filter="–ù–∞–≥–∞—Ç–∏–Ω—Å–∫–∏–π –∑–∞—Ç–æ–Ω">–º. –ù–∞–≥–∞—Ç–∏–Ω—Å–∫–∏–π –∑–∞—Ç–æ–Ω</li>
    <li class="text-black cursor-pointer hover:text-blue-600" data-filter="–ö–∞–Ω—Ç–µ–º–∏—Ä–æ–≤—Å–∫–∞—è">–º. –ö–∞–Ω—Ç–µ–º–∏—Ä–æ–≤—Å–∫–∞—è</li>
    <li class="text-black cursor-pointer hover:text-blue-600" data-filter="–û—Ä–µ—Ö–æ–≤–æ">–º. –û—Ä–µ—Ö–æ–≤–æ</li>
    <li class="text-black cursor-pointer hover:text-blue-600" data-filter="–¶–∞—Ä–∏—Ü—ã–Ω–æ">–º. –¶–∞—Ä–∏—Ü—ã–Ω–æ</li>
  </ul>
</div>
      </th>
      <th class="p-3 text-left">–§–ò–û –†–æ–¥–∏—Ç–µ–ª—è</th>
      <th class="p-3 text-left">–¢–µ–ª–µ—Ñ–æ–Ω</th>
      <th class="p-3 text-left">–§–ò–û –†–µ–±–µ–Ω–∫–∞</th>
      <th class="p-3 text-left">–î–∞—Ç–∞</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
        <div class="mt-6">
          <button id="exportExcel" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
            –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel
          </button>
        </div>
      </section>
    </main>
  </div>

  <!-- ‚öôÔ∏è JS -->
<script>
// === –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ ===
const tabButtons = document.querySelectorAll('.tab-btn');
const tabs = document.querySelectorAll('.tab-content');
tabButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    tabButtons.forEach(b => b.classList.remove('active', 'bg-white', 'text-blue-700'));
    btn.classList.add('active', 'bg-white', 'text-blue-700');
    const tabId = btn.dataset.tab;
    tabs.forEach(t => t.classList.add('hidden'));
    document.getElementById(tabId).classList.remove('hidden');
  });
});


// === –°–õ–ê–ô–î–ï–†–´ ===
const sliderList = document.getElementById('sliderList');
const sliderData = [];

async function saveSliders() {
  await fetch('save_sliders.php', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify(sliderData)
  });
}

async function loadSliders() {
  try {
    const res = await fetch('sliders.json');
    if (!res.ok) return;
    const data = await res.json();
    sliderData.length = 0;
    sliderData.push(...data);
    renderSliders();
  } catch (e) {
    console.warn('–ù–µ—Ç sliders.json, —Å–æ–∑–¥–∞—Å—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');
  }
}

document.getElementById('addSlider').addEventListener('click', () => {
  const title = document.getElementById('sliderTitle').value.trim();
  const desc = document.getElementById('sliderDesc').value.trim();
  const file = document.getElementById('sliderImage').files[0];
  if (!title) return alert('–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫!');

  const slide = { id: Date.now(), title, desc, img: '', editing: false };
  if (file) {
    const reader = new FileReader();
    reader.onload = async () => {
      slide.img = reader.result;
      sliderData.push(slide);
      await renderSliders();
      clearSliderForm();
    };
    reader.readAsDataURL(file);
  } else {
    sliderData.push(slide);
    renderSliders();
    clearSliderForm();
  }
});

function clearSliderForm() {
  document.getElementById('sliderTitle').value = '';
  document.getElementById('sliderDesc').value = '';
  document.getElementById('sliderImage').value = '';
}

async function renderSliders() {
  sliderList.innerHTML = '';
  sliderData.forEach(slide => {
    const card = document.createElement('div');
    card.className = 'bg-white rounded-2xl shadow overflow-hidden';
    const imageBlock = slide.img ? `<img src="${slide.img}" class="w-full h-48 object-cover">` : '';
    const content = slide.editing
      ? `
        ${imageBlock}
        <div class="p-4 space-y-2">
          <input type="text" class="titleInput w-full border rounded px-2 py-1 font-bold" value="${slide.title}">
          <textarea class="descInput w-full border rounded px-2 py-1 text-sm text-gray-600">${slide.desc || ''}</textarea>
          <div class="flex justify-between mt-2">
            <button class="saveBtn bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button class="deleteBtn bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm">–£–¥–∞–ª–∏—Ç—å</button>
          </div>
        </div>`
      : `
        ${imageBlock}
        <div class="p-4 space-y-2">
          <h4 class="font-bold text-lg">${slide.title}</h4>
          <p class="text-sm text-gray-600">${slide.desc || ''}</p>
          <div class="flex justify-between mt-2">
            <button class="editBtn bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            <button class="deleteBtn bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm">–£–¥–∞–ª–∏—Ç—å</button>
          </div>
        </div>`;
    card.innerHTML = content;

    card.querySelector('.editBtn')?.addEventListener('click', () => {
      slide.editing = true;
      renderSliders();
    });

    card.querySelector('.saveBtn')?.addEventListener('click', async () => {
      slide.title = card.querySelector('.titleInput').value.trim();
      slide.desc = card.querySelector('.descInput').value.trim();
      slide.editing = false;
      await renderSliders();
    });

    card.querySelector('.deleteBtn')?.addEventListener('click', async () => {
      const i = sliderData.findIndex(s => s.id === slide.id);
      if (i !== -1) sliderData.splice(i, 1);
      await renderSliders();
    });

    sliderList.appendChild(card);
  });
  await saveSliders();
}

loadSliders();


// === –ù–û–í–û–°–¢–ò ===
const newsList = document.getElementById('newsList');
const newsData = [];

document.getElementById('addNews').addEventListener('click', () => {
  const title = document.getElementById('newsTitle').value.trim();
  const text = document.getElementById('newsContent').value.trim();
  if (!title || !text) return alert('–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ç–µ–∫—Å—Ç!');
  const news = { id: Date.now(), title, text, date: new Date().toLocaleString(), editing: false };
  newsData.push(news);
  renderNews();
  document.getElementById('newsTitle').value = '';
  document.getElementById('newsContent').value = '';
});

function renderNews() {
  newsList.innerHTML = '';
  newsData.forEach(n => {
    const card = document.createElement('div');
    card.className = 'bg-white rounded-2xl shadow overflow-hidden';
    const content = n.editing
      ? `
        <div class="p-4 space-y-2">
          <input type="text" class="titleInput w-full border rounded px-2 py-1 font-bold" value="${n.title}">
          <textarea class="descInput w-full border rounded px-2 py-1 text-sm text-gray-700">${n.text}</textarea>
          <p class="text-gray-500 text-sm">${n.date}</p>
          <div class="flex justify-between mt-2">
            <button class="saveBtn bg-green-600 text-white px-3 py-1 rounded text-sm">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button class="deleteBtn bg-red-600 text-white px-3 py-1 rounded text-sm">–£–¥–∞–ª–∏—Ç—å</button>
          </div>
        </div>`
      : `
        <div class="p-4 space-y-2">
          <h4 class="font-bold text-lg">${n.title}</h4>
          <p class="text-gray-700 text-sm">${n.text}</p>
          <p class="text-gray-500 text-sm">${n.date}</p>
          <div class="flex justify-between mt-2">
            <button class="editBtn bg-blue-600 text-white px-3 py-1 rounded text-sm">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            <button class="deleteBtn bg-red-600 text-white px-3 py-1 rounded text-sm">–£–¥–∞–ª–∏—Ç—å</button>
          </div>
        </div>`;
    card.innerHTML = content;

    card.querySelector('.editBtn')?.addEventListener('click', () => {
      n.editing = true;
      renderNews();
    });

    card.querySelector('.saveBtn')?.addEventListener('click', () => {
      n.title = card.querySelector('.titleInput').value.trim();
      n.text = card.querySelector('.descInput').value.trim();
      n.editing = false;
      renderNews();
    });

    card.querySelector('.deleteBtn')?.addEventListener('click', () => {
      const i = newsData.findIndex(x => x.id === n.id);
      if (i !== -1) newsData.splice(i, 1);
      renderNews();
    });

    newsList.appendChild(card);
  });
}


// === –ë–ê–ó–ê –î–ê–ù–ù–´–• ===
const dataTableBody = document.querySelector('#dataTable tbody');

async function loadDatabase() {
  try {
    const res = await fetch('get_data.php');
    const rows = await res.json();
    if (!Array.isArray(rows)) {
      alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ë–î');
      return;
    }
    dataTableBody.innerHTML = '';
    rows.forEach(r => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="p-3 border-b">${r.id}</td>
        <td class="p-3 border-b">${r.department}</td>
        <td class="p-3 border-b">${r.parent_name}</td>
        <td class="p-3 border-b">${r.phone}</td>
        <td class="p-3 border-b">${r.child_name}</td>
        <td class="p-3 border-b">${r.birth_date}</td>`;
      dataTableBody.appendChild(tr);
    });
  } catch (err) {
    console.error(err);
    alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö');
  }
}

document.querySelector('[data-tab="database"]').addEventListener('click', loadDatabase);

const deptHeader = document.getElementById('departmentHeader');
const deptArrow = document.getElementById('deptArrow');
const metroList = document.getElementById('metroList');
let dbRows = [];


// === –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –º–µ—Ç—Ä–æ ===
metroList.classList.add(
  'transition-all',
  'duration-500',
  'overflow-hidden',
  'max-h-0',
  'opacity-0'
);

let isMetroOpen = false;

// –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ç—Ä–µ–ª–∫–∏
deptArrow.classList.add('transition-transform', 'duration-300', 'rotate-0');

// –æ—Ç–∫—Ä—ã—Ç–∏–µ / –∑–∞–∫—Ä—ã—Ç–∏–µ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
deptHeader.addEventListener('click', () => {
  if (!isMetroOpen) {
    metroList.classList.remove('hidden');
    requestAnimationFrame(() => {
      metroList.classList.remove('max-h-0', 'opacity-0');
      metroList.classList.add('max-h-64', 'opacity-100');
    });
    deptArrow.classList.remove('rotate-0');
    deptArrow.classList.add('rotate-180');
    isMetroOpen = true;
  } else {
    metroList.classList.add('max-h-0', 'opacity-0');
    metroList.classList.remove('max-h-64', 'opacity-100');
    deptArrow.classList.remove('rotate-180');
    deptArrow.classList.add('rotate-0');
    setTimeout(() => metroList.classList.add('hidden'), 400);
    isMetroOpen = false;
  }
});

// –∫–ª–∏–∫ –≤–Ω–µ —Å–ø–∏—Å–∫–∞ ‚Äî –∑–∞–∫—Ä—ã—Ç—å
document.addEventListener('click', e => {
  if (isMetroOpen && !deptHeader.contains(e.target) && !metroList.contains(e.target)) {
    metroList.classList.add('max-h-0', 'opacity-0');
    metroList.classList.remove('max-h-64', 'opacity-100');
    deptArrow.classList.remove('rotate-180');
    deptArrow.classList.add('rotate-0'); // –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç—Ä–µ–ª–∫—É
    setTimeout(() => metroList.classList.add('hidden'), 400);
    isMetroOpen = false;
  }
});

// —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
function renderTable(rows) {
  dataTableBody.innerHTML = '';
  rows.forEach(r => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="p-3 border-b">${r.id}</td>
      <td class="p-3 border-b">${r.department}</td>
      <td class="p-3 border-b">${r.parent_name}</td>
      <td class="p-3 border-b">${r.phone}</td>
      <td class="p-3 border-b">${r.child_name}</td>
      <td class="p-3 border-b">${r.birth_date}</td>`;
    dataTableBody.appendChild(tr);
  });
}

// –∑–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç—å
async function loadDatabase() {
  try {
    const res = await fetch('get_data.php');
    dbRows = await res.json();
    renderTable(dbRows);
  } catch (err) {
    console.error(err);
    alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö');
  }
}

// –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –ø–æ –ø—É–Ω–∫—Ç–∞–º –º–µ—Ç—Ä–æ
metroList.querySelectorAll('li').forEach(item => {
  item.addEventListener('click', () => {
    const filter = item.dataset.filter;

    if (!Array.isArray(dbRows) || dbRows.length === 0) {
      alert('–î–∞–Ω–Ω—ã–µ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
      return;
    }

    const filtered = filter === 'all'
      ? dbRows
      : dbRows.filter(r => r.department.includes(filter));

    renderTable(filtered);

    // —Å—Ç—Ä–µ–ª–∫–∞ —Å—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ
    deptArrow.classList.remove('rotate-180');
    deptArrow.classList.add('rotate-0');

    // –ø–ª–∞–≤–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫
    metroList.classList.add('max-h-0', 'opacity-0');
    metroList.classList.remove('max-h-64', 'opacity-100');
    setTimeout(() => {
      metroList.classList.add('hidden');
      isMetroOpen = false;
    }, 300);
  });
});




// –∑–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏
document.querySelector('[data-tab="database"]').addEventListener('click', loadDatabase);








// === –≠–ö–°–ü–û–†–¢ –í EXCEL ===
document.getElementById('exportExcel').addEventListener('click', async () => {
  const res = await fetch('get_data.php');
  const rows = await res.json();
  if (!Array.isArray(rows) || rows.length === 0) {
    alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞!');
    return;
  }
  const ws = XLSX.utils.json_to_sheet(rows);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, '–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö');
  XLSX.writeFile(wb, 'database.xlsx');
});
</script>




</body>
</html>
